#!/bin/bash

. common

broken=''

for i in ${depPkgName}; do
	_pushd build/${i}/${svnbranch}
	unset pkgname
	. PKGBUILD
	if [ ${#pkgname[@]} -gt 1 ]; then
		for j in ${pkgname[@]}; do
			mkdir -p pkg/${j}
			tar -xJf ${j}-${pkgver}-${pkgrel}-${CARCH}${PKGEXT} -C pkg/${j}
		done
	else
		mkdir pkg
		tar -xJf ${i}-${pkgver}-${pkgrel}-${CARCH}${PKGEXT} -C pkg/
	fi
	_popd
done

for i in ${optPkgName}; do
	_pushd build/${i}/${svnbranch}
	unset pkgname
	. PKGBUILD
	if [ ${#pkgname[@]} -gt 1 ]; then
		for j in ${pkgname[@]}; do
			mkdir -p pkg/${j}
			tar -xJf ${j}-${pkgver}-${pkgrel}-${CARCH}${PKGEXT} -C pkg/${j}
		done
	else
		mkdir pkg
		tar -xJf ${i}-${pkgver}-${pkgrel}-${CARCH}${PKGEXT} -C pkg/
	fi
	_popd
done

if [ "${broken}" != "" ]; then
	echo "Broken packages: ${broken}"
fi
