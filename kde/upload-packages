#!/bin/bash

. common

for i in ${depPkgName} ${optPkgName} ${l10nPkgName}; do
	_pushd build/${i}/${svnbranch}
	unset pkgname
	. PKGBUILD
	for j in ${pkgname[@]}; do
		for a in ${arch[@]}; do
			if [ -f ${j}-${pkgver}-${pkgrel}-${a}${PKGEXT} ]; then
				pkgfile=${j}-${pkgver}-${pkgrel}-${a}${PKGEXT}
				scp "${pkgfile}" gerolde.archlinux.org:staging/${repo}/
				if [ "$(md5sum "${pkgfile}" | cut -d' ' -f1)" != "$(ssh gerolde.archlinux.org md5sum "staging/${repo}/${pkgfile}" | cut -d' ' -f1)" ]; then
					echo "${pkgfile} got corrupted during upload!"
				fi
			fi
		done
	done
	_popd
done
