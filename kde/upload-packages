#!/bin/bash

. common

upload() {
	unset pkgname
	. PKGBUILD
	for i in ${pkgname[@]}; do
		pkgfile=${i}-${pkgver}-${pkgrel}-${1}${PKGEXT}
		scp "${pkgfile}" archlinux.org:staging/${repo}/
		if [ "$(md5sum "${pkgfile}" | cut -d' ' -f1)" != "$(ssh archlinux.org md5sum "staging/${repo}/${pkgfile}" | cut -d' ' -f1)" ]; then
			echo "${pkgfile} got corrupted during upload!"
		fi
	done
}

for i in ${depPkgName} ${optPkgName}; do
	_pushd build/${i}/${svnbranch}
	upload ${CARCH}
	_popd
done

for i in ${l10nPkgName}; do
	_pushd build/${i}/${svnbranch}
	upload any
	_popd
done
