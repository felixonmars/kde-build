#!/bin/bash

. common

pkglist=''

for i in ${depPkgName} ${optPkgName}; do
	_pushd build/${i}/${svnbranch}
	unset pkgname
	. PKGBUILD
	pkglist="${pkglist} build/${i}/${svnbranch}/namcap-PKGBUILD.log"
	for j in ${pkgname[@]}; do
		for a in ${arch[@]}; do
			if [ -f ${j}-${pkgver}-${pkgrel}-${a}${PKGEXT} ]; then
				pkgfile=${j}-${pkgver}-${pkgrel}-${a}${PKGEXT}
				pkglist="${pkglist} build/${i}/${svnbranch}/namcap-${pkgfile}.log"
			fi
		done
	done
	_popd
done

cat ${pkglist} | grep -v -e '/etc/ssl/certs/ca-certificates.crt' \
		         -e 'hicolor-icon-theme' \
		         -e 'on your system is a testing release' \
		         -e 'points to non-existing /usr/share/doc/' \
		         -e 'kdebase-runtime E: Dependency detected and not included (xine-lib)' \
		         -e 'Potential non-FHS man page (usr/share/doc' \
		         -e 'Potential non-FHS info page (usr/share/doc' \
		         -e "Dependency included and not needed ('kdebase-runtime')" \
		         -e "Dependency included and not needed ('kdepim-runtime')" \
	| less
